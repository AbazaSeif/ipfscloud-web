<!doctype html>
<html class="no-js" lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IPFS Cloud</title>

  <link rel="shortcut icon" href="https://gateway.ipfs.io/ipfs/QmSPpDKfkanJMJrjAyVsSAxSUZUe8hswYUdqcQPZFDRvnQ">

  <!-- Facebook and Twitter integration -->
  <meta property="og:title" content="IPFS Cloud"/>
  <meta property="og:image:type" content="image/jpeg" />
  <meta property="og:image" content="https://gateway.ipfs.io/ipfs/QmRz5obNbnr6ShiKxpU5cJf67dXfCmRXyT9eEVELzrEyyE"/>
  <meta property="og:url" content="http://ipfscloud.store" />
  <meta property="og:site_name" content="IpfsCloud"/>
  <meta property="og:description" content="A Decentralised Cloud Storage Platform. Upload and Store documents, Photos, Videos, Movies. A fully decentralized, free and unlimited cloud storage platform."/>
  <meta property="og:image:alt" content="IpfsCloud" />
  <meta name="description" content="A Decentralised Cloud Storage Platform. Upload and Store documents, Photos, Videos, Movies. A fully decentralized, free and unlimited cloud storage platform.">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
    crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="css/shards.min.css?v=2.0.1">
  <link rel="stylesheet" href="css/shards-demo.min.css?v=2.0.1">
  <link rel="stylesheet" href="css/loader.css">

  <!--FIREBASE-->
  <script src="https://www.gstatic.com/firebasejs/5.4.2/firebase.js"></script>
  

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script src="https://unpkg.com/ipfs-api/dist/index.min.js"></script>
  <script src="js/bundle.js"></script>
  <script src="js/qrcode.js"></script>
</head>

<body>
  <div class="loader">
    <div class="page-loader"></div>
  </div>

  <!-- Floating Logo -->
  

  <!--Other logos-->
  <!--
    white logo small: https://gateway.ipfs.io/ipfs/Qma5cPfuVWw21a4787czwJvpEHfPrsBk3UG6nmxmWyTSGL
    white logo big: https://gateway.ipfs.io/ipfs/QmR1HX19JiMMh5HUzzE9Xc9jWjJMMn7XkGcatAsotb6YWc
    black logo: https://gateway.ipfs.io/ipfs/QmfMZKjD8Ce6pyfMq9w8xrLvFetaFvpPcp1agEde3VQ7KA
    green logo: https://gateway.ipfs.io/ipfs/QmVxCb7AaRG1Hpf45mmR8ZUkSYU2Rf7UTXWUqANwqZar4X
  -->


  <!-- Welcome Section -->
  <div class="welcome d-flex justify-content-center flex-column">
    <div class="inner-wrapper mt-auto mb-auto">
      <h1 class="slide-in">IpfsCloud</h1>
      <p class="slide-in">A Decentralised Cloud Storage Platform.</p>
      <div class="action-links slide-in">
        <div class="section-title col-lg-8 col-md-10 ml-auto mr-auto">
          <h6 class="text-muted mb-3">Upload documents, Photos, Videos, Movies...</h6>
            <fieldset>
              <div class="custom-file w-100" id="upload">
                <form onSubmit={this.onSubmit} id="uploadForm">
                  <input type="file" class="custom-file-input" id="customFile"/>
                    <label class="custom-file-label" for="customFile">Choose file...</label>
                </form>
              </div>
              <br><br>
              <h6 class="text-muted mb-3" id="uploadStatus">Ready to Upload</h6>
            </fieldset>
            <small id="userId" data-toggle="modal" data-target="#exampleModal">Current User: No Current User. Please login via Metamask or any other web3 provider.</small>
        </div>
      </div>
    </div>
    <div class="product-by">
      <a href="https://ipfs.io" target="_blank">
        <p>Powered By</p>
        <img src="https://gateway.ipfs.io/ipfs/QmZUGJv8auabS2VuL2JMYuP6VPFtKnPMZEFNJE3736oCCg" width="5%" height="5%">
      </a>
    </div>
    

<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Scan and Sync with your Mobile Device</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <center><div id="qrcode" style="width:200px; height:200px; margin-top:15px;"></div></center>
      </div>
    </div>
  </div>
</div>

  </div>

  <!-- Page Content -->
  <div class="page-content">
    <!-- Content -->
    <div class="content clearfix">

      <div id="cards" class="container mb-2" style="padding-bottom: 1px">
        <div class="section-title col-lg-8 col-md-10 ml-auto mr-auto">
          <h3 class="mb-4">Your Documents</h3>
          <hr>
          <div class="btn-group btn-group-toggle" data-toggle="buttons">
            <label class="btn btn-outline-primary active">
              <input type="radio" name="options" id="option1" autocomplete="off" checked="" onclick="showFirebase()"> Cloud
            </label>
            <label class="btn btn-outline-primary">
              <input type="radio" name="options" id="option2" autocomplete="off" onclick="showBlockchain()"> Blockchain
            </label>
          </div>
          <p></p>
        </div>
        <div id="documentList">No document uploaded</div>
      </div>


      <div id="cards" class="container mb-2" style="padding-bottom: 1px">
        <div class="section-title col-lg-8 col-md-10 ml-auto mr-auto">
          <h3 class="mb-4">Shared with me</h3>
          <hr>
          <div class="btn-group btn-group-toggle" data-toggle="buttons">
            <label class="btn btn-outline-primary active">
              <input type="radio" name="options" id="option1" autocomplete="off" checked="" onclick="showFirebase()"> Cloud
            </label>
            <label class="btn btn-outline-primary">
              <input type="radio" name="options" id="option2" autocomplete="off" onclick="showBlockchain()"> Blockchain
            </label>
          </div>
          <p></p>
        </div>
        <div id="sharedList">No shared documents</div>
      </div>

      <footer class="main-footer py-5">
      <p class="text-muted text-center small p-0 mb-4">&copy; Copyright 2018 â€” vasa</p>
      <div class="social d-table mx-auto">
        <a class="twitter mx-3 h4 d-inline-block text-secondary" href="https://twitter.com/vasa_develop" target="_blank">
          <i class="fa fa-twitter"></i>
          <span class="sr-only">View my Twitter Profile</span>
        </a>
        <a class="facebook mx-3 h4 d-inline-block text-secondary" href="https://medium.com/@vaibhavsaini_67863" target="_blank">
          <i class="fa fa-medium"></i>
          <span class="sr-only">View my Medium Profile
            <span>
        </a>
        <a class="github mx-3 h4 d-inline-block text-secondary" href="https://github.com/vasa-develop" target="_blank">
          <i class="fa fa-github"></i>
          <span class="sr-only">View my GitHub Profile</span>
        </a>
        <a class="facebook mx-3 h4 d-inline-block text-secondary" href="https://www.facebook.com/vasa.developx" target="_blank">
          <i class="fa fa-facebook"></i>
          <span class="sr-only">View my Facebook Profile
            <span>
        </a>
        <a class="facebook mx-3 h4 d-inline-block text-secondary" href="mailto:vasa@towardsblockchain.com" target="_blank">
          <i class="fa fa-envelope"></i>
          <span class="sr-only">Contact me via email
            <span>
        </a>
      </div>
    </footer>


    </div>
  </div>

      

  <script type="text/javascript">
    
    web3.currentProvider.publicConfigStore.on('update', function(){
      window.location = window.location.href;
    });

    function share(a){
      console.log("SHARE: "+a.value);
      
      var firestore = firebase.firestore();
      var userDocRef = firestore.doc("users/0x1158f15e74dcec06aeaeeba5b0eaa8461c73db36");

      userDocRef.get().then((doc) => {
        if(doc && doc.exists){
          const myData = doc.data();

          var shared = myData.shared;

          shared[a.value] = {"ipfsHash": a.value, "sharedBy": web3.eth.accounts[0], "isSavedOnBlockchain": false};

          userDocRef.update({"shared": shared}).then(() => {
            //document shared via cloud
            console.log("Document shared successfully via cloud.");
          }).catch((error) => {
            //failed to share document via cloud. 
            console.log("Some error occurred while sharing document via cloud: "+error);
          });

        }
        else{
          console.log("User doesnot exist!");
        }
      });
    }

    function submitToBlockchain(a, type){
      console.log("type: "+type);
      web3.eth.defaultAccount = web3.eth.accounts[0];
      console.log("ACCOUNT: "+ web3.eth.defaultAccount);
      var EthGramCore = web3.eth.contract([
  {
    "constant": false,
    "inputs": [
      {
        "name": "data",
        "type": "string"
      },
      {
        "name": "separator",
        "type": "string"
      }
    ],
    "name": "AddImageData",
    "outputs": [],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "getUserData",
    "outputs": [
      {
        "name": "",
        "type": "string"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  }
]);

              var EthGram = EthGramCore.at('0x4047b5cc5b52ce72fe158b89c9dd8a0a5ae11329');

              EthGram.AddImageData(a.value, ",", function(error, result){
                  if(error){
                      console.log("Error submitting data to blockchain!!");
                  }
                  else{
                      console.log("TransactionHash: ",result);
                      //update database
                      var firestore = firebase.firestore();
                      var userDocRef = firestore.doc("users/"+web3.eth.defaultAccount);
                      userDocRef.get().then((doc)=>{
                        if(doc && doc.exists){
                          var myData = doc.data();
                          myData.documents[a.value].isSavedOnBlockchain = true;
                          userDocRef.update({"documents": myData.documents}).then(()=>{
                            console.log("Updated status of database successfully.");
                          }).catch((error)=>{
                            console.log("Some error occurred while update status of the database: "+error);
                          });
                        }
                      });

                      /*userDocRef.get().then((doc) => {
                        const myData = doc.data();
                        
                        myData
                      });*/

                  }
              });
    }
  </script>
  <script type="text/javascript">
    var qrcode = new QRCode(document.getElementById("qrcode"), {
      width : 200,
      height : 200
    });
    function makeCode () {
      qrcode.makeCode(web3.eth.accounts[0]);
    }
    makeCode();
    </script>
  <!-- JavaScript -->
  <div id="fb-root"></div>
  <script async defer src="https://buttons.github.io/buttons.js"></script>
  <script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4"
    crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>
  <script src="js/shards.min.js"></script>
  <script src="js/demo.min.js"></script>

</body>

</html>